{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\by130\\\\\\uBB38\\uC11C\\\\by_code\\\\project4.1\\\\\\uC0C8 \\uD3F4\\uB354\\\\gesture_kiosk_9\\\\front\\\\src\\\\WebcamCapture.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from 'react';\nimport './WebcamCapture.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst WebcamCapture = ({\n  onStream\n}) => {\n  _s();\n  const [action, setAction] = useState('?');\n  const videoRef = useRef(null);\n  const ws = useRef(null);\n  useEffect(() => {\n    const getMediaStream = async () => {\n      try {\n        const mediaStream = await navigator.mediaDevices.getUserMedia({\n          video: true\n        });\n        videoRef.current.srcObject = mediaStream;\n        if (typeof onStream === 'function') {\n          onStream(mediaStream);\n        }\n        ws.current = new WebSocket('ws://localhost:8000');\n        ws.current.onopen = () => {\n          console.log('WebSocket connection opened');\n        };\n        ws.current.onclose = () => {\n          console.log('WebSocket connection closed');\n        };\n        ws.current.onerror = error => {\n          console.error('WebSocket error:', error);\n        };\n        ws.current.onmessage = message => {\n          setAction(message.data);\n        };\n        setInterval(() => {\n          const canvas = document.createElement('canvas');\n          canvas.width = videoRef.current.videoWidth;\n          canvas.height = videoRef.current.videoHeight;\n          const ctx = canvas.getContext('2d');\n          ctx.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n          canvas.toBlob(blob => {\n            if (ws.current && ws.current.readyState === WebSocket.OPEN) {\n              ws.current.send(blob);\n            }\n          }, 'image/jpeg');\n        }, 100);\n      } catch (error) {\n        console.error('웹캠에 접근하는 중 오류가 발생했습니다.', error);\n      }\n    };\n    getMediaStream();\n    return () => {\n      if (ws.current) {\n        ws.current.close();\n      }\n    };\n  }, [onStream]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"webcam-capture-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"video\", {\n      ref: videoRef,\n      autoPlay: true,\n      playsInline: true,\n      className: \"webcam-video\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"action-display\",\n      children: action\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 5\n  }, this);\n};\n_s(WebcamCapture, \"Rk02pdqahJkEZBXYgtpp/1Y2OHs=\");\n_c = WebcamCapture;\nexport default WebcamCapture;\nvar _c;\n$RefreshReg$(_c, \"WebcamCapture\");","map":{"version":3,"names":["React","useEffect","useState","useRef","jsxDEV","_jsxDEV","WebcamCapture","onStream","_s","action","setAction","videoRef","ws","getMediaStream","mediaStream","navigator","mediaDevices","getUserMedia","video","current","srcObject","WebSocket","onopen","console","log","onclose","onerror","error","onmessage","message","data","setInterval","canvas","document","createElement","width","videoWidth","height","videoHeight","ctx","getContext","drawImage","toBlob","blob","readyState","OPEN","send","close","className","children","ref","autoPlay","playsInline","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/by130/문서/by_code/project4.1/새 폴더/gesture_kiosk_9/front/src/WebcamCapture.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\r\nimport './WebcamCapture.css';\r\n\r\nconst WebcamCapture = ({ onStream }) => {\r\n  const [action, setAction] = useState('?');\r\n  const videoRef = useRef(null);\r\n  const ws = useRef(null);\r\n\r\n  useEffect(() => {\r\n    const getMediaStream = async () => {\r\n      try {\r\n        const mediaStream = await navigator.mediaDevices.getUserMedia({ video: true });\r\n        videoRef.current.srcObject = mediaStream;\r\n\r\n        if (typeof onStream === 'function') {\r\n          onStream(mediaStream);\r\n        }\r\n\r\n        ws.current = new WebSocket('ws://localhost:8000');\r\n\r\n        ws.current.onopen = () => {\r\n          console.log('WebSocket connection opened');\r\n        };\r\n\r\n        ws.current.onclose = () => {\r\n          console.log('WebSocket connection closed');\r\n        };\r\n\r\n        ws.current.onerror = (error) => {\r\n          console.error('WebSocket error:', error);\r\n        };\r\n\r\n        ws.current.onmessage = (message) => {\r\n          setAction(message.data);\r\n        };\r\n\r\n        setInterval(() => {\r\n          const canvas = document.createElement('canvas');\r\n          canvas.width = videoRef.current.videoWidth;\r\n          canvas.height = videoRef.current.videoHeight;\r\n          const ctx = canvas.getContext('2d');\r\n          ctx.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\r\n          canvas.toBlob((blob) => {\r\n            if (ws.current && ws.current.readyState === WebSocket.OPEN) {\r\n              ws.current.send(blob);\r\n            }\r\n          }, 'image/jpeg');\r\n        }, 100);\r\n      } catch (error) {\r\n        console.error('웹캠에 접근하는 중 오류가 발생했습니다.', error);\r\n      }\r\n    };\r\n\r\n    getMediaStream();\r\n\r\n    return () => {\r\n      if (ws.current) {\r\n        ws.current.close();\r\n      }\r\n    };\r\n  }, [onStream]);\r\n\r\n  return (\r\n    <div className=\"webcam-capture-container\">\r\n      <video ref={videoRef} autoPlay playsInline className=\"webcam-video\" />\r\n      <div className=\"action-display\">{action}</div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default WebcamCapture;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}